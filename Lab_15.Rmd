---
title: "Lab_15"
author: "Lil Rascals"
date: "April 30, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
Exams <- read.csv("StudentsPerformance.csv", sep = ",")
library(tidyverse)
library(dplyr)
library(ggplot2)
library(cowplot)
library(stringr)
library(gapminder)
library(lubridate)
```

### Overall Question
How are factors like race, gender, parent's education impacting test performance of students?

This question is extremely important in discovering what trends exist and which students are more likely to succeed in their tests. It will be interesting to see if there is a difference in scores between genders or races. We would also expect an increase in scores somewhat proportionate to an increase in parent's education. 
=======
### Individual SubQuestions
#### Kelsey's SubQuestion
How does being on free or reduced lunch impact your test scores?
This question is extremely important in determining whether students who are less advantaged financially do worse on their tests. This could translate to finding policies to even out student incomes and opportunities. Policies that should support these students even further should be applied if their scores are in fact lower. First I tested the scores for math, then others. 
```{r}
Exams1 <- Exams %>% filter(lunch == "free/reduced") 
perm_mean <- function(perms = 1000, n1)
{
  mean_mat <- matrix(0,1000,1)

  for (i in c(1:perms))
  {
    rsamp <- sample(Exams1$math.score, n1, replace = FALSE)
    A <- mean(rsamp)
    B <- mean(Exams$math.score)
    mean_mat[[i]] <- (A-B)
  }
  return(mean_mat)
}
mean(Exams$math.score)
means <- as.tibble(perm_mean( n1=33))
sd(Exams$V1)
realdiff <- mean(Exams1$math.score)- mean(Exams$math.score)
realdiff
std <- sqrt( (sd(Exams$math.score))^2/length(Exams1$math.score))
z_score <- realdiff/std
z_score
ggplot(means, aes(x=V1 ))+geom_histogram(binwidth=1)+
  xlab("Means")+
  geom_vline(xintercept = realdiff, color = "red", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Math Test Scores with Free/Reduced Lunch")
perm_mean <- function(perms = 1000, n1)
{
  mean_mat <- matrix(0,1000,1)

  for (i in c(1:perms))
  {
    rsamp <- sample(Exams1$reading.score, n1, replace = FALSE)
    A <- mean(rsamp)
    B <- mean(Exams$reading.score)
    mean_mat[[i]] <- (A-B)
  }
  return(mean_mat)
}
mean(Exams$reading.score)
means <- as.tibble(perm_mean( n1=33))
sd(Exams$V1)
realdiff <- mean(Exams1$reading.score)- mean(Exams$reading.score)
realdiff
std <- sqrt( (sd(Exams$reading.score))^2/length(Exams1$reading.score))
z_score <- realdiff/std
z_score
ggplot(means, aes(x=V1 ))+geom_histogram(binwidth=1)+
  xlab("Means")+
  geom_vline(xintercept = realdiff, color = "red", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Reading Test Scores with Free/Reduced Lunch")

```
From the results above it is clear that there is an enormous discrepancy between students who have free and reduced lunch and the average student's test scores. Clearly, students on free or reduced lunch have lower math scores by 7.167 points. Through a permutation test we can see that the difference is present if we run 1000 trials and that the real difference between the two is very obvious. Since our z-score is so enormous 8.9, we know that there is very little change that the difference between these two groups is due to chance alone. Therefore, we can conclude that the results are statistically significant and students with free and reduced lunch have consistently lower math test scores than other students.
I repeated this process for reading scores and found that it was still statistically significant, but that the difference in scores between the two groups was lower at 4.5 points for those students on free and reduced lunch. Our z-score was 5.8 so our data was still statistically significant. 


#### James' Subquestion
How does completing the test preparation course affect the test scores?
This question is very important because not everyone has the equal acess to such courses and tutors based on their social status. If this course has a legitemate affect on the test scores then it is an unfair advantage that should be offered in a way that gives everyone equal access. However if it does not truely affect the scores than it could be a waste of time.
```{r}
Exams3 <- Exams %>% filter(test.preparation.course == "completed") 
perm_mean2 <- function(perms = 1000, n1)
{
  mean_mat <- matrix(0,1000,1)

  for (i in c(1:perms))
  {
    rsamp1 <- sample(Exams3$math.score, n1, replace = FALSE)
    A <- mean(rsamp1)
    B <- mean(Exams$math.score)
    mean_mat[[i]] <- (A-B)
  }
  return(mean_mat)
}
mean(Exams$math.score)
means <- as.tibble(perm_mean2( n1=33))
sd(Exams$V1)
realdiff <- mean(Exams3$math.score)- mean(Exams$math.score)
realdiff
std <- sqrt( (sd(Exams$math.score))^2/length(Exams3$math.score))
z_score <- realdiff/std
z_score
ggplot(means, aes(x=V1 ))+
  geom_histogram(binwidth=1)+
  xlab("Means")+
  geom_vline(xintercept = realdiff, color = "red", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Math Test Scores with Test Prep")

perm_mean3 <- function(perms = 1000, n1)
{
  mean_mat <- matrix(0,1000,1)

  for (i in c(1:perms))
  {
    rsamp1 <- sample(Exams3$writing.score, n1, replace = FALSE)
    A <- mean(rsamp1)
    B <- mean(Exams$writing.score)
    mean_mat[[i]] <- (A-B)
  }
  return(mean_mat)
}
mean(Exams$writing.score)
means <- as.tibble(perm_mean3( n1=33))
sd(Exams$V1)
realdiff2 <- mean(Exams3$writing.score)- mean(Exams$writing.score)
realdiff2
std <- sqrt( (sd(Exams$writing.score))^2/length(Exams3$writing.score))
z_score2 <- realdiff/std
z_score2
ggplot(means, aes(x=V1 ))+
  geom_histogram(binwidth=1)+
  xlab("Means")+
  geom_vline(xintercept = realdiff2, color = "red", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Writing Test Scores with Test Prep")

perm_mean4 <- function(perms = 1000, n1)
{
  mean_mat <- matrix(0,1000,1)

  for (i in c(1:perms))
  {
    rsamp1 <- sample(Exams3$reading.score, n1, replace = FALSE)
    A <- mean(rsamp1)
    B <- mean(Exams$reading.score)
    mean_mat[[i]] <- (A-B)
  }
  return(mean_mat)
}
mean(Exams$reading.score)
means <- as.tibble(perm_mean4( n1=33))
sd(Exams$V1)
realdiff3 <- mean(Exams3$reading.score)- mean(Exams$reading.score)
realdiff3
std <- sqrt( (sd(Exams$reading.score))^2/length(Exams3$reading.score))
z_score3 <- realdiff/std
z_score3
ggplot(means, aes(x=V1 ))+
  geom_histogram(binwidth=1)+
  xlab("Means")+
  geom_vline(xintercept = realdiff3, color = "red", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Reading Test Scores with Test Prep")

```
From my results it is obvious that the test prep course has a legitemate affect of the test scores. I would expect to get this result because that is generally the case. looking at the difference in means for those who completed the course and the means of everyone, those who took it generally do 3.6 points better on the math portion, 6.4 points better on the writing portion and 4.7 points better on the reading portion. I would say this is a significant difference especially because all three differences add together, to make a sizable differnece in total score. However we must look to the z-score to see how substantial it is. The z-score for reading is about 4.7 and about 4.5 for both math and writing, which is quite large and shows that these difference in means are most likely not due to chance, but instead are casued by the factor of the test prep course.


#### Shreeya's Subquestion
Are there differences in test scores between male and female students?

```{r}
examsGender <- Exams %>% filter(gender == "female")
examsMale <- Exams %>% filter(gender == "male")
perm_mean <- function(perms = 1000, n1)
{
  mean_mat <- matrix(0,1000,1)

  for (i in c(1:perms))
  {
    rsamp <- sample(examsGender$math.score, n1, replace = FALSE)
    A <- mean(rsamp)
    B <- mean(examsMale$math.score)
    mean_mat[[i]] <- (A-B)
  }
  return(mean_mat)
}
mean(Exams$math.score)
means <- as.tibble(perm_mean( n1=33))
sd(Exams$V1)
realdiff <- mean(examsGender$math.score)- mean(examsMale$math.score)
realdiff
std <- sqrt( (sd(examsMale$math.score))^2/length(examsGender$math.score))
z_score <- realdiff/std
z_score
ggplot(means, aes(x=V1 ))+geom_histogram(binwidth=1)+
  xlab("Means")+
  geom_vline(xintercept = realdiff, color = "orange", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Math Test Scores Between Male and Female Students")
######
perm_mean <- function(perms = 1000, n1)
{
  mean_read <- matrix(0,1000,1)

  for (i in c(1:perms))
  {
    rsamp <- sample(examsGender$reading.score, n1, replace = FALSE)
    A <- mean(rsamp)
    B <- mean(examsMale$reading.score)
    mean_read[[i]] <- (A-B)
  }
  return(mean_read)
}
mean(Exams$reading.score)
means <- as.tibble(perm_mean( n1=33))
sd(Exams$V1)
realdiff <- mean(examsGender$reading.score)- mean(examsMale$reading.score)
realdiff
std <- sqrt( (sd(examsMale$reading.score))^2/length(examsGender$reading.score))
z_score <- realdiff/std
z_score
ggplot(means, aes(x=V1 ))+geom_histogram(binwidth=1)+
  xlab("Means")+
  geom_vline(xintercept = realdiff, color = "purple", size = .3)+
  ylab("Number")+
  ggtitle("Difference in Means in Reading Test Scores Between Male and Female Students")
```
Findings:
  Using permutation tests to compare the difference in scores betweeen male and female students for the math and reading tests, I found that female students did on average five points worse than their male counterparts on the math test and about 7 points better on the reading test. The implications of these tests indicate further research into why female students are doing worse in math and better in english is necessary. A z score of 11.65 indicates these tests are statistically significant. 

### Team Conclusion
Overall, we found that having a student on free or reduced lunch means there is generally a lower score on the tests. We also found that on average those who completed test prep did better on the exams. 
Therefore, we would recommend implementing better anti-poverty policies in order to reduce the amount of students who rely on free and reduced lunch. Also, we could increase support for these students in ways such as having extra tutoring options for them or providing extra test prep classes for them to decrease the difference between the two groups test scores. 
In addition, we could mandate or encourage the completion of test prep courses for students since completing test prep is correlated with a better performance on tests. 

### Lab 2 Reflection


#### Kelsey's Reflection
In lab 2, one of my goals was to get better at R throughout the course of this class. I have learned so much about R and R-studio formatting and manipulating data. I have learned how to do permutation tests and gotten better at ggplot. I have come so far and learned so much throughout this class. I feel that I have gotten so much better at R and the tools it comes with. I would say my long term goals are very similar. Although I feel like now I know more about my plans for the future since I am graduating in a week. I also had my assignment for peace corps changed on me and I now leave for Lesotho in September. 

####Shreeya's Reflection
  My long term goals have not changed significantly. I think that I suceeded in my goal of learning to program in R and to use those tools to work with data more knowledgeably than I did at the start of the semester. I've learned a lot about data and what working with data means and I've come very far from when I started the class with no programming knowledge in R and very little statistical knowledge.  

#### James' Reflection
  